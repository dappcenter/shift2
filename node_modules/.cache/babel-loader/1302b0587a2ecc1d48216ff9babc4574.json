{"ast":null,"code":"import _regeneratorRuntime from\"/Users/rp/Desktop/death/quest/answers/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/rp/Desktop/death/quest/answers/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/rp/Desktop/death/quest/answers/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _taggedTemplateLiteral from\"/Users/rp/Desktop/death/quest/answers/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";var _templateObject;import React,{useState,useCallback}from'react';import styled from'styled-components';import{getAddress}from'utils/addressHelpers';import{getBep20Contract}from'utils/contractHelpers';import{Button,Flex,Text}from'@pancakeswap-libs/uikit';import{useFarmFromSymbol,useFarmUser}from'state/hooks';import useI18n from'hooks/useI18n';import useWeb3 from'hooks/useWeb3';import{useApprove}from'hooks/useApprove';import UnlockButton from'components/UnlockButton';import StakeAction from'./StakeAction';import HarvestAction from'./HarvestAction';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Action=styled.div(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  padding-top: 16px;\\n\"])));var CardActions=function CardActions(_ref){var farm=_ref.farm,account=_ref.account,addLiquidityUrl=_ref.addLiquidityUrl;var TranslateString=useI18n();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),requestedApproval=_useState2[0],setRequestedApproval=_useState2[1];var _useFarmFromSymbol=useFarmFromSymbol(farm.lpSymbol),pid=_useFarmFromSymbol.pid,lpAddresses=_useFarmFromSymbol.lpAddresses;var _useFarmUser=useFarmUser(pid),allowance=_useFarmUser.allowance,tokenBalance=_useFarmUser.tokenBalance,stakedBalance=_useFarmUser.stakedBalance,earnings=_useFarmUser.earnings;var lpAddress=getAddress(lpAddresses);var lpName=farm.lpSymbol.toUpperCase();var isApproved=account&&allowance&&allowance.isGreaterThan(0);var web3=useWeb3();var lpContract=getBep20Contract(lpAddress,web3);var _useApprove=useApprove(lpContract),onApprove=_useApprove.onApprove;var handleApprove=useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;setRequestedApproval(true);_context.next=4;return onApprove();case 4:setRequestedApproval(false);_context.next=10;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);console.error(_context.t0);case 10:case\"end\":return _context.stop();}}},_callee,null,[[0,7]]);})),[onApprove]);var renderApprovalOrStakeButton=function renderApprovalOrStakeButton(){return isApproved?/*#__PURE__*/_jsx(StakeAction,{stakedBalance:stakedBalance,tokenBalance:tokenBalance,tokenName:lpName,pid:pid,addLiquidityUrl:addLiquidityUrl}):/*#__PURE__*/_jsx(Button,{mt:\"8px\",width:\"100%\",disabled:requestedApproval,onClick:handleApprove,children:TranslateString(758,'Approve Contract')});};return/*#__PURE__*/_jsxs(Action,{children:[/*#__PURE__*/_jsxs(Flex,{children:[/*#__PURE__*/_jsx(Text,{bold:true,textTransform:\"uppercase\",color:\"secondary\",fontSize:\"12px\",pr:\"3px\",children:\"?\"}),/*#__PURE__*/_jsx(Text,{bold:true,textTransform:\"uppercase\",color:\"textSubtle\",fontSize:\"12px\",children:TranslateString(1072,'Earned')})]}),/*#__PURE__*/_jsx(HarvestAction,{earnings:earnings,pid:pid}),/*#__PURE__*/_jsxs(Flex,{children:[/*#__PURE__*/_jsx(Text,{bold:true,textTransform:\"uppercase\",color:\"secondary\",fontSize:\"12px\",pr:\"3px\",children:lpName}),/*#__PURE__*/_jsx(Text,{bold:true,textTransform:\"uppercase\",color:\"textSubtle\",fontSize:\"12px\",children:TranslateString(1074,'Staked')})]}),!account?/*#__PURE__*/_jsx(UnlockButton,{mt:\"8px\",width:\"100%\"}):renderApprovalOrStakeButton()]});};export default CardActions;","map":{"version":3,"sources":["/Users/rp/Desktop/death/quest/answers/src/views/Farms/components/FarmCard/CardActionsContainer.tsx"],"names":["React","useState","useCallback","styled","getAddress","getBep20Contract","Button","Flex","Text","useFarmFromSymbol","useFarmUser","useI18n","useWeb3","useApprove","UnlockButton","StakeAction","HarvestAction","Action","div","CardActions","farm","account","addLiquidityUrl","TranslateString","requestedApproval","setRequestedApproval","lpSymbol","pid","lpAddresses","allowance","tokenBalance","stakedBalance","earnings","lpAddress","lpName","toUpperCase","isApproved","isGreaterThan","web3","lpContract","onApprove","handleApprove","console","error","renderApprovalOrStakeButton"],"mappings":"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","sourcesContent":["import React, { useState, useCallback } from 'react'\r\nimport BigNumber from 'bignumber.js'\r\nimport styled from 'styled-components'\r\nimport { provider as ProviderType } from 'web3-core'\r\nimport { getAddress } from 'utils/addressHelpers'\r\nimport { getBep20Contract } from 'utils/contractHelpers'\r\nimport { Button, Flex, Text } from '@pancakeswap-libs/uikit'\r\nimport { Farm } from 'state/types'\r\nimport { useFarmFromSymbol, useFarmUser } from 'state/hooks'\r\nimport useI18n from 'hooks/useI18n'\r\nimport useWeb3 from 'hooks/useWeb3'\r\nimport { useApprove } from 'hooks/useApprove'\r\nimport UnlockButton from 'components/UnlockButton'\r\nimport StakeAction from './StakeAction'\r\nimport HarvestAction from './HarvestAction'\r\n\r\nconst Action = styled.div`\r\n  padding-top: 16px;\r\n`\r\nexport interface FarmWithStakedValue extends Farm {\r\n  apy?: BigNumber\r\n}\r\n\r\ninterface FarmCardActionsProps {\r\n  farm: FarmWithStakedValue\r\n  provider?: ProviderType\r\n  account?: string\r\n  addLiquidityUrl?: string\r\n}\r\n\r\nconst CardActions: React.FC<FarmCardActionsProps> = ({ farm, account, addLiquidityUrl }) => {\r\n  const TranslateString = useI18n()\r\n  const [requestedApproval, setRequestedApproval] = useState(false)\r\n  const { pid, lpAddresses } = useFarmFromSymbol(farm.lpSymbol)\r\n  const { allowance, tokenBalance, stakedBalance, earnings } = useFarmUser(pid)\r\n  const lpAddress = getAddress(lpAddresses)\r\n  const lpName = farm.lpSymbol.toUpperCase()\r\n  const isApproved = account && allowance && allowance.isGreaterThan(0)\r\n  const web3 = useWeb3()\r\n\r\n  const lpContract = getBep20Contract(lpAddress, web3)\r\n\r\n  const { onApprove } = useApprove(lpContract)\r\n\r\n  const handleApprove = useCallback(async () => {\r\n    try {\r\n      setRequestedApproval(true)\r\n      await onApprove()\r\n      setRequestedApproval(false)\r\n    } catch (e) {\r\n      console.error(e)\r\n    }\r\n  }, [onApprove])\r\n\r\n  const renderApprovalOrStakeButton = () => {\r\n    return isApproved ? (\r\n      <StakeAction\r\n        stakedBalance={stakedBalance}\r\n        tokenBalance={tokenBalance}\r\n        tokenName={lpName}\r\n        pid={pid}\r\n        addLiquidityUrl={addLiquidityUrl}\r\n      />\r\n    ) : (\r\n      <Button mt=\"8px\" width=\"100%\" disabled={requestedApproval} onClick={handleApprove}>\r\n        {TranslateString(758, 'Approve Contract')}\r\n      </Button>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <Action>\r\n      <Flex>\r\n        <Text bold textTransform=\"uppercase\" color=\"secondary\" fontSize=\"12px\" pr=\"3px\">\r\n          {/* TODO: Is there a way to get a dynamic value here from useFarmFromSymbol? */}\r\n          ?\r\n        </Text>\r\n        <Text bold textTransform=\"uppercase\" color=\"textSubtle\" fontSize=\"12px\">\r\n          {TranslateString(1072, 'Earned')}\r\n        </Text>\r\n      </Flex>\r\n      <HarvestAction earnings={earnings} pid={pid} />\r\n      <Flex>\r\n        <Text bold textTransform=\"uppercase\" color=\"secondary\" fontSize=\"12px\" pr=\"3px\">\r\n          {lpName}\r\n        </Text>\r\n        <Text bold textTransform=\"uppercase\" color=\"textSubtle\" fontSize=\"12px\">\r\n          {TranslateString(1074, 'Staked')}\r\n        </Text>\r\n      </Flex>\r\n      {!account ? <UnlockButton mt=\"8px\" width=\"100%\" /> : renderApprovalOrStakeButton()}\r\n    </Action>\r\n  )\r\n}\r\n\r\nexport default CardActions\r\n"]},"metadata":{},"sourceType":"module"}