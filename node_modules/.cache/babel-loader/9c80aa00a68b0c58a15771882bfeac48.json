{"ast":null,"code":"import _regeneratorRuntime from\"/Users/rp/Desktop/death/answers/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/rp/Desktop/death/answers/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/rp/Desktop/death/answers/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _taggedTemplateLiteral from\"/Users/rp/Desktop/death/answers/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";var _templateObject;import React,{useState,useCallback}from'react';import styled from'styled-components';import{Button,useModal,IconButton,AddIcon,MinusIcon}from'@pancakeswap-libs/uikit';import UnlockButton from'components/UnlockButton';import{useWeb3React}from'@web3-react/core';import{useFarmUser}from'state/hooks';import useI18n from'hooks/useI18n';import{useApprove}from'hooks/useApprove';import{getBep20Contract}from'utils/contractHelpers';import{BASE_ADD_LIQUIDITY_URL}from'config';import getLiquidityUrlPathParts from'utils/getLiquidityUrlPathParts';import{getBalanceNumber}from'utils/formatBalance';import useStake from'hooks/useStake';import useUnstake from'hooks/useUnstake';import useWeb3 from'hooks/useWeb3';import DepositModal from'../../DepositModal';import WithdrawModal from'../../WithdrawModal';import{ActionContainer,ActionTitles,ActionContent,Earned,Title,Subtle}from'./styles';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var IconButtonWrapper=styled.div(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  display: flex;\\n\"])));var Staked=function Staked(_ref){var pid=_ref.pid,lpSymbol=_ref.lpSymbol,lpAddresses=_ref.lpAddresses,quoteTokenAdresses=_ref.quoteTokenAdresses,tokenAddresses=_ref.tokenAddresses;var TranslateString=useI18n();var _useWeb3React=useWeb3React(),account=_useWeb3React.account;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),requestedApproval=_useState2[0],setRequestedApproval=_useState2[1];var _useFarmUser=useFarmUser(pid),allowance=_useFarmUser.allowance,tokenBalance=_useFarmUser.tokenBalance,stakedBalance=_useFarmUser.stakedBalance;var _useStake=useStake(pid),onStake=_useStake.onStake;var _useUnstake=useUnstake(pid),onUnstake=_useUnstake.onUnstake;var web3=useWeb3();var isApproved=account&&allowance&&allowance.isGreaterThan(0);var lpAddress=lpAddresses[process.env.REACT_APP_CHAIN_ID];var liquidityUrlPathParts=getLiquidityUrlPathParts({quoteTokenAdresses:quoteTokenAdresses,tokenAddresses:tokenAddresses});var addLiquidityUrl=\"\".concat(BASE_ADD_LIQUIDITY_URL,\"/\").concat(liquidityUrlPathParts);var rawStakedBalance=getBalanceNumber(stakedBalance);var displayBalance=rawStakedBalance.toLocaleString();var _useModal=useModal(/*#__PURE__*/_jsx(DepositModal,{max:tokenBalance,onConfirm:onStake,tokenName:lpSymbol,addLiquidityUrl:addLiquidityUrl})),_useModal2=_slicedToArray(_useModal,1),onPresentDeposit=_useModal2[0];var _useModal3=useModal(/*#__PURE__*/_jsx(WithdrawModal,{max:stakedBalance,onConfirm:onUnstake,tokenName:lpSymbol})),_useModal4=_slicedToArray(_useModal3,1),onPresentWithdraw=_useModal4[0];var lpContract=getBep20Contract(lpAddress,web3);var _useApprove=useApprove(lpContract),onApprove=_useApprove.onApprove;var handleApprove=useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;setRequestedApproval(true);_context.next=4;return onApprove();case 4:setRequestedApproval(false);_context.next=10;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);console.error(_context.t0);case 10:case\"end\":return _context.stop();}}},_callee,null,[[0,7]]);})),[onApprove]);if(!account){return/*#__PURE__*/_jsxs(ActionContainer,{children:[/*#__PURE__*/_jsx(ActionTitles,{children:/*#__PURE__*/_jsx(Subtle,{children:TranslateString(999,'START FARMING')})}),/*#__PURE__*/_jsx(ActionContent,{children:/*#__PURE__*/_jsx(UnlockButton,{width:\"100%\"})})]});}if(isApproved){if(rawStakedBalance){return/*#__PURE__*/_jsxs(ActionContainer,{children:[/*#__PURE__*/_jsxs(ActionTitles,{children:[/*#__PURE__*/_jsxs(Title,{children:[lpSymbol,\" \"]}),/*#__PURE__*/_jsx(Subtle,{children:TranslateString(999,'STAKED')})]}),/*#__PURE__*/_jsxs(ActionContent,{children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Earned,{children:displayBalance})}),/*#__PURE__*/_jsxs(IconButtonWrapper,{children:[/*#__PURE__*/_jsx(IconButton,{variant:\"secondary\",onClick:onPresentWithdraw,mr:\"6px\",children:/*#__PURE__*/_jsx(MinusIcon,{color:\"primary\",width:\"14px\"})}),/*#__PURE__*/_jsx(IconButton,{variant:\"secondary\",onClick:onPresentDeposit,children:/*#__PURE__*/_jsx(AddIcon,{color:\"primary\",width:\"14px\"})})]})]})]});}return/*#__PURE__*/_jsxs(ActionContainer,{children:[/*#__PURE__*/_jsxs(ActionTitles,{children:[/*#__PURE__*/_jsxs(Subtle,{children:[TranslateString(999,'STAKE'),\" \"]}),/*#__PURE__*/_jsx(Title,{children:lpSymbol})]}),/*#__PURE__*/_jsx(ActionContent,{children:/*#__PURE__*/_jsx(Button,{width:\"100%\",onClick:onPresentDeposit,variant:\"secondary\",children:TranslateString(999,'Stake LP')})})]});}return/*#__PURE__*/_jsxs(ActionContainer,{children:[/*#__PURE__*/_jsx(ActionTitles,{children:/*#__PURE__*/_jsx(Subtle,{children:TranslateString(999,'ENABLE FARM')})}),/*#__PURE__*/_jsx(ActionContent,{children:/*#__PURE__*/_jsx(Button,{width:\"100%\",disabled:requestedApproval,onClick:handleApprove,variant:\"secondary\",children:TranslateString(999,'Enable')})})]});};export default Staked;","map":{"version":3,"sources":["/Users/rp/Desktop/death/answers/src/views/Farms/components/FarmTable/Actions/StakedAction.tsx"],"names":["React","useState","useCallback","styled","Button","useModal","IconButton","AddIcon","MinusIcon","UnlockButton","useWeb3React","useFarmUser","useI18n","useApprove","getBep20Contract","BASE_ADD_LIQUIDITY_URL","getLiquidityUrlPathParts","getBalanceNumber","useStake","useUnstake","useWeb3","DepositModal","WithdrawModal","ActionContainer","ActionTitles","ActionContent","Earned","Title","Subtle","IconButtonWrapper","div","Staked","pid","lpSymbol","lpAddresses","quoteTokenAdresses","tokenAddresses","TranslateString","account","requestedApproval","setRequestedApproval","allowance","tokenBalance","stakedBalance","onStake","onUnstake","web3","isApproved","isGreaterThan","lpAddress","process","env","REACT_APP_CHAIN_ID","liquidityUrlPathParts","addLiquidityUrl","rawStakedBalance","displayBalance","toLocaleString","onPresentDeposit","onPresentWithdraw","lpContract","onApprove","handleApprove","console","error"],"mappings":"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","sourcesContent":["import React, { useState, useCallback } from 'react'\nimport styled from 'styled-components'\nimport { Button, useModal, IconButton, AddIcon, MinusIcon } from '@pancakeswap-libs/uikit'\nimport UnlockButton from 'components/UnlockButton'\nimport { useWeb3React } from '@web3-react/core'\nimport { useFarmUser } from 'state/hooks'\nimport { FarmWithStakedValue } from 'views/Farms/components/FarmCard/FarmCard'\nimport useI18n from 'hooks/useI18n'\nimport { useApprove } from 'hooks/useApprove'\nimport { getBep20Contract } from 'utils/contractHelpers'\nimport { BASE_ADD_LIQUIDITY_URL } from 'config'\nimport getLiquidityUrlPathParts from 'utils/getLiquidityUrlPathParts'\nimport { getBalanceNumber } from 'utils/formatBalance'\nimport useStake from 'hooks/useStake'\nimport useUnstake from 'hooks/useUnstake'\nimport useWeb3 from 'hooks/useWeb3'\n\nimport DepositModal from '../../DepositModal'\nimport WithdrawModal from '../../WithdrawModal'\nimport { ActionContainer, ActionTitles, ActionContent, Earned, Title, Subtle } from './styles'\n\nconst IconButtonWrapper = styled.div`\n  display: flex;\n`\n\nconst Staked: React.FunctionComponent<FarmWithStakedValue> = ({\n  pid,\n  lpSymbol,\n  lpAddresses,\n  quoteTokenAdresses,\n  tokenAddresses,\n}) => {\n  const TranslateString = useI18n()\n  const { account } = useWeb3React()\n  const [requestedApproval, setRequestedApproval] = useState(false)\n  const { allowance, tokenBalance, stakedBalance } = useFarmUser(pid)\n  const { onStake } = useStake(pid)\n  const { onUnstake } = useUnstake(pid)\n  const web3 = useWeb3()\n\n  const isApproved = account && allowance && allowance.isGreaterThan(0)\n\n  const lpAddress = lpAddresses[process.env.REACT_APP_CHAIN_ID]\n  const liquidityUrlPathParts = getLiquidityUrlPathParts({ quoteTokenAdresses, tokenAddresses })\n  const addLiquidityUrl = `${BASE_ADD_LIQUIDITY_URL}/${liquidityUrlPathParts}`\n  const rawStakedBalance = getBalanceNumber(stakedBalance)\n  const displayBalance = rawStakedBalance.toLocaleString()\n\n  const [onPresentDeposit] = useModal(\n    <DepositModal max={tokenBalance} onConfirm={onStake} tokenName={lpSymbol} addLiquidityUrl={addLiquidityUrl} />,\n  )\n  const [onPresentWithdraw] = useModal(<WithdrawModal max={stakedBalance} onConfirm={onUnstake} tokenName={lpSymbol} />)\n\n  const lpContract = getBep20Contract(lpAddress, web3)\n\n  const { onApprove } = useApprove(lpContract)\n\n  const handleApprove = useCallback(async () => {\n    try {\n      setRequestedApproval(true)\n      await onApprove()\n      setRequestedApproval(false)\n    } catch (e) {\n      console.error(e)\n    }\n  }, [onApprove])\n\n  if (!account) {\n    return (\n      <ActionContainer>\n        <ActionTitles>\n          <Subtle>{TranslateString(999, 'START FARMING')}</Subtle>\n        </ActionTitles>\n        <ActionContent>\n          <UnlockButton width=\"100%\" />\n        </ActionContent>\n      </ActionContainer>\n    )\n  }\n\n  if (isApproved) {\n    if (rawStakedBalance) {\n      return (\n        <ActionContainer>\n          <ActionTitles>\n            <Title>{lpSymbol} </Title>\n            <Subtle>{TranslateString(999, 'STAKED')}</Subtle>\n          </ActionTitles>\n          <ActionContent>\n            <div>\n              <Earned>{displayBalance}</Earned>\n            </div>\n            <IconButtonWrapper>\n              <IconButton variant=\"secondary\" onClick={onPresentWithdraw} mr=\"6px\">\n                <MinusIcon color=\"primary\" width=\"14px\" />\n              </IconButton>\n              <IconButton variant=\"secondary\" onClick={onPresentDeposit}>\n                <AddIcon color=\"primary\" width=\"14px\" />\n              </IconButton>\n            </IconButtonWrapper>\n          </ActionContent>\n        </ActionContainer>\n      )\n    }\n\n    return (\n      <ActionContainer>\n        <ActionTitles>\n          <Subtle>{TranslateString(999, 'STAKE')} </Subtle>\n          <Title>{lpSymbol}</Title>\n        </ActionTitles>\n        <ActionContent>\n          <Button width=\"100%\" onClick={onPresentDeposit} variant=\"secondary\">\n            {TranslateString(999, 'Stake LP')}\n          </Button>\n        </ActionContent>\n      </ActionContainer>\n    )\n  }\n\n  return (\n    <ActionContainer>\n      <ActionTitles>\n        <Subtle>{TranslateString(999, 'ENABLE FARM')}</Subtle>\n      </ActionTitles>\n      <ActionContent>\n        <Button width=\"100%\" disabled={requestedApproval} onClick={handleApprove} variant=\"secondary\">\n          {TranslateString(999, 'Enable')}\n        </Button>\n      </ActionContent>\n    </ActionContainer>\n  )\n}\n\nexport default Staked\n"]},"metadata":{},"sourceType":"module"}