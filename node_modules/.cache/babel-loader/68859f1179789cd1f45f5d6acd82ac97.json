{"ast":null,"code":"import _objectSpread from\"/Volumes/evo970/shift2-fcb8bc041d1fedb7988290b70457fa426765e2f4/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Volumes/evo970/shift2-fcb8bc041d1fedb7988290b70457fa426765e2f4/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _taggedTemplateLiteral from\"/Volumes/evo970/shift2-fcb8bc041d1fedb7988290b70457fa426765e2f4/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";var _templateObject,_templateObject2,_templateObject3,_templateObject4,_templateObject5,_templateObject6,_templateObject7;import React,{useEffect,useCallback,useState}from'react';import{Route,useRouteMatch,useLocation}from'react-router-dom';import{useDispatch}from'react-redux';import BigNumber from'bignumber.js';import{useWeb3React}from'@web3-react/core';import{Image,Heading,Toggle,Text}from'@pancakeswap-libs/uikit';import styled from'styled-components';import{BLOCKS_PER_YEAR,SHIFT_PER_BLOCK,SHIFT_POOL_PID}from'config';import FlexLayout from'components/layout/Flex';import Page from'components/layout/Page';import{useFarms,usePriceBnbBusd,usePriceCakeBusd,usePriceEthBusd}from'state/hooks';import useRefresh from'hooks/useRefresh';import{fetchFarmUserDataAsync}from'state/actions';import{QuoteToken}from'config/constants/types';import useI18n from'hooks/useI18n';import{getBalanceNumber}from'utils/formatBalance';import{orderBy}from'lodash';import FarmCard from'./components/FarmCard/FarmCard';import Table from'./components/FarmTable/FarmTable';import FarmTabButtons from'./components/FarmTabButtons';import SearchInput from'./components/SearchInput';import ToggleView from'./components/ToggleView/ToggleView';import{DesktopColumnSchema,ViewMode}from'./components/types';import Select from'./components/Select/Select';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var ControlContainer=styled.div(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  display: flex;\\n  width: 100%;\\n  align-items: center;\\n  position: relative;\\n\\n  justify-content: space-between;\\n  flex-direction: column;\\n\\n  \",\" {\\n    flex-direction: row;\\n    flex-wrap: wrap;\\n    padding: 16px 32px;\\n    background: rgb(33, 33, 49);\\n\\n  }\\n\"])),function(_ref){var theme=_ref.theme;return theme.mediaQueries.sm;});var ToggleWrapper=styled.div(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n  display: flex;\\n  align-items: center;\\n  margin-left: 10px;\\n\\n  \",\" {\\n    margin-left: 8px;\\n  }\\n\"])),Text);var LabelWrapper=styled.div(_templateObject3||(_templateObject3=_taggedTemplateLiteral([\"\\n  > \",\" {\\n    font-size: 12px;\\n  }\\n\"])),Text);var FilterContainer=styled.div(_templateObject4||(_templateObject4=_taggedTemplateLiteral([\"\\n  display: flex;\\n  align-items: center;\\n  width: 100%;\\n  padding: 8px 0px;\\n\\n  \",\" {\\n    width: auto;\\n    padding: 0;\\n  }\\n\"])),function(_ref2){var theme=_ref2.theme;return theme.mediaQueries.sm;});var ViewControls=styled.div(_templateObject5||(_templateObject5=_taggedTemplateLiteral([\"\\n  flex-wrap: wrap;\\n  justify-content: space-between;\\n  display: flex;\\n  align-items: center;\\n  width: 100%;\\n\\n  > div {\\n    padding: 8px 0px;\\n  }\\n\\n  \",\" {\\n    justify-content: flex-start;\\n    width: auto;\\n\\n    > div {\\n      padding: 0;\\n    }\\n  }\\n\"])),function(_ref3){var theme=_ref3.theme;return theme.mediaQueries.sm;});var StyledImage=styled(Image)(_templateObject6||(_templateObject6=_taggedTemplateLiteral([\"\\n  margin-left: auto;\\n  margin-right: auto;\\n  margin-top: 58px;\\n\"])));var Header=styled.div(_templateObject7||(_templateObject7=_taggedTemplateLiteral([\"\\n  padding: 22px 0px;\\n  // background: \",\";\\n  margin-left: 16%;\\n\\n  padding-left: 76px;\\n  padding-right: 16px;\\n\\n  \",\" {\\n    padding-left: 24px;\\n    padding-right: 24px;\\n  }\\n\"])),function(_ref4){var theme=_ref4.theme;return theme.colors.gradients.bubblegum;},function(_ref5){var theme=_ref5.theme;return theme.mediaQueries.sm;});var Farms=function Farms(){var _useRouteMatch=useRouteMatch(),path=_useRouteMatch.path;var _useLocation=useLocation(),pathname=_useLocation.pathname;var TranslateString=useI18n();var farmsLP=useFarms();var cakePrice=usePriceCakeBusd();var bnbPrice=usePriceBnbBusd();var _useState=useState(''),_useState2=_slicedToArray(_useState,2),query=_useState2[0],setQuery=_useState2[1];var _useState3=useState(ViewMode.TABLE),_useState4=_slicedToArray(_useState3,2),viewMode=_useState4[0],setViewMode=_useState4[1];var ethPriceUsd=usePriceEthBusd();var _useWeb3React=useWeb3React(),account=_useWeb3React.account;var _useState5=useState('hot'),_useState6=_slicedToArray(_useState5,2),sortOption=_useState6[0],setSortOption=_useState6[1];var dispatch=useDispatch();var _useRefresh=useRefresh(),fastRefresh=_useRefresh.fastRefresh;useEffect(function(){if(account){dispatch(fetchFarmUserDataAsync(account));}},[account,dispatch,fastRefresh]);var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),stackedOnly=_useState8[0],setStackedOnly=_useState8[1];var activeFarms=farmsLP.filter(function(farm){return farm.pid!==0&&farm.multiplier!=='0X';});var inactiveFarms=farmsLP.filter(function(farm){return farm.pid!==0&&farm.multiplier==='0X';});var stackedOnlyFarms=activeFarms.filter(function(farm){return farm.userData&&new BigNumber(farm.userData.stakedBalance).isGreaterThan(0);});var sortFarms=function sortFarms(farms){switch(sortOption){case'apr':return orderBy(farms,'apy','desc');case'multiplier':return orderBy(farms,function(farm){return Number(farm.multiplier.slice(0,-1));},'desc');case'earned':return orderBy(farms,function(farm){return farm.userData?farm.userData.earnings:0;},'desc');case'liquidity':return orderBy(farms,function(farm){return Number(farm.liquidity);},'desc');default:return farms;}};// /!\\ This function will be removed soon\n// This function compute the APY for each farm and will be replaced when we have a reliable API\n// to retrieve assets prices against USD\nvar farmsList=useCallback(function(farmsToDisplay){var _farmsLP$find;var cakePriceVsBNB=new BigNumber(((_farmsLP$find=farmsLP.find(function(farm){return farm.pid===SHIFT_POOL_PID;}))===null||_farmsLP$find===void 0?void 0:_farmsLP$find.tokenPriceVsQuote)||0);var farmsToDisplayWithAPY=farmsToDisplay.map(function(farm){if(!farm.tokenAmount||!farm.lpTotalInQuoteToken){return farm;}var cakeRewardPerBlock=SHIFT_PER_BLOCK.times(farm.poolWeight);var cakeRewardPerYear=cakeRewardPerBlock.times(BLOCKS_PER_YEAR);// cakePriceInQuote * cakeRewardPerYear / lpTotalInQuoteToken\nvar apy=cakePriceVsBNB.times(cakeRewardPerYear).div(farm.lpTotalInQuoteToken);if(farm.quoteTokenSymbol===QuoteToken.BUSD||farm.quoteTokenSymbol===QuoteToken.UST){apy=cakePriceVsBNB.times(cakeRewardPerYear).div(farm.lpTotalInQuoteToken).times(bnbPrice);}else if(farm.quoteTokenSymbol===QuoteToken.ETH){apy=cakePrice.div(ethPriceUsd).times(cakeRewardPerYear).div(farm.lpTotalInQuoteToken);}else if(farm.quoteTokenSymbol===QuoteToken.SHIFT){apy=cakeRewardPerYear.div(farm.lpTotalInQuoteToken);}else if(farm.dual){var cakeApy=farm&&cakePriceVsBNB.times(cakeRewardPerBlock).times(BLOCKS_PER_YEAR).div(farm.lpTotalInQuoteToken);var dualApy=farm.tokenPriceVsQuote&&new BigNumber(farm.tokenPriceVsQuote).times(farm.dual.rewardPerBlock).times(BLOCKS_PER_YEAR).div(farm.lpTotalInQuoteToken);apy=cakeApy&&dualApy&&cakeApy.plus(dualApy);}var liquidity=farm.lpTotalInQuoteToken;if(!farm.lpTotalInQuoteToken){liquidity=null;}if(farm.quoteTokenSymbol===QuoteToken.BNB){liquidity=bnbPrice.times(farm.lpTotalInQuoteToken);}if(farm.quoteTokenSymbol===QuoteToken.SHIFT){liquidity=cakePrice.times(farm.lpTotalInQuoteToken);}if(farm.quoteTokenSymbol===QuoteToken.ETH){liquidity=ethPriceUsd.times(farm.lpTotalInQuoteToken);}return _objectSpread(_objectSpread({},farm),{},{apy:apy,liquidity:liquidity});});if(query){var lowercaseQuery=query.toLowerCase();farmsToDisplayWithAPY=farmsToDisplayWithAPY.filter(function(farm){if(farm.lpSymbol.toLowerCase().includes(lowercaseQuery)){return true;}return false;});}return farmsToDisplayWithAPY;},[bnbPrice,farmsLP,query,cakePrice,ethPriceUsd]);var handleChangeQuery=function handleChangeQuery(event){setQuery(event.target.value);};var isActive=!pathname.includes('history');var farmsStaked=[];if(isActive){farmsStaked=stackedOnly?farmsList(stackedOnlyFarms):farmsList(activeFarms);}else{farmsStaked=farmsList(inactiveFarms);}farmsStaked=sortFarms(farmsStaked);var rowData=farmsStaked.map(function(farm){var quoteTokenAdresses=farm.quoteTokenAdresses,quoteTokenSymbol=farm.quoteTokenSymbol,tokenAddresses=farm.tokenAddresses;var lpLabel=farm.lpSymbol&&farm.lpSymbol.split(' ')[0].toUpperCase().replace('PANSHIFT','');var row={apr:{value:farm.apy&&farm.apy.times(new BigNumber(100)).toNumber().toLocaleString('en-US',{maximumFractionDigits:2}),multiplier:farm.multiplier,lpLabel:lpLabel,quoteTokenAdresses:quoteTokenAdresses,quoteTokenSymbol:quoteTokenSymbol,tokenAddresses:tokenAddresses,cakePrice:cakePrice,originalValue:farm.apy},farm:{image:farm.lpSymbol.split(' ')[0].toLocaleLowerCase(),label:lpLabel,pid:farm.pid},earned:{earnings:farm.userData?getBalanceNumber(new BigNumber(farm.userData.earnings)):null,pid:farm.pid},liquidity:{liquidity:farm.liquidity},multiplier:{multiplier:farm.multiplier},details:farm};return row;});var renderContent=function renderContent(){if(viewMode===ViewMode.TABLE&&rowData.length){var columnSchema=DesktopColumnSchema;var columns=columnSchema.map(function(column){return{id:column.id,name:column.name,label:column.label,sort:function sort(a,b){switch(column.name){case'farm':return b.id-a.id;case'apr':if(a.original.apr.value&&b.original.apr.value){return Number(a.original.apr.value)-Number(b.original.apr.value);}return 0;case'earned':return a.original.earned.earnings-b.original.earned.earnings;default:return 1;}},sortable:column.sortable};});return/*#__PURE__*/_jsx(Table,{data:rowData,columns:columns});}return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(FlexLayout,{children:[/*#__PURE__*/_jsx(Route,{exact:true,path:\"\".concat(path),children:farmsStaked.map(function(farm){return/*#__PURE__*/_jsx(FarmCard,{farm:farm,bnbPrice:bnbPrice,cakePrice:cakePrice,ethPrice:ethPriceUsd,account:account,removed:false},farm.pid);})}),/*#__PURE__*/_jsx(Route,{exact:true,path:\"\".concat(path,\"/history\"),children:farmsStaked.map(function(farm){return/*#__PURE__*/_jsx(FarmCard,{farm:farm,bnbPrice:bnbPrice,cakePrice:cakePrice,ethPrice:ethPriceUsd,account:account,removed:true},farm.pid);})})]})});};var handleSortOptionChange=function handleSortOptionChange(option){setSortOption(option.value);};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Header,{children:/*#__PURE__*/_jsx(Heading,{as:\"h3\",size:\"xxl\",color:\"white\",mb:\"4px\",padding:\"80px\",children:TranslateString(999,'LIQUIDITY FARM')})}),/*#__PURE__*/_jsxs(Page,{children:[/*#__PURE__*/_jsxs(ControlContainer,{children:[/*#__PURE__*/_jsxs(ViewControls,{children:[/*#__PURE__*/_jsx(ToggleView,{viewMode:viewMode,onToggle:function onToggle(mode){return setViewMode(mode);}}),/*#__PURE__*/_jsxs(ToggleWrapper,{children:[/*#__PURE__*/_jsx(Toggle,{checked:stackedOnly,onChange:function onChange(){return setStackedOnly(!stackedOnly);},scale:\"sm\"}),/*#__PURE__*/_jsxs(Text,{children:[\" \",TranslateString(1116,'Staked only')]})]}),/*#__PURE__*/_jsx(FarmTabButtons,{})]}),/*#__PURE__*/_jsxs(FilterContainer,{children:[/*#__PURE__*/_jsxs(LabelWrapper,{children:[/*#__PURE__*/_jsx(Text,{children:\"FILTER BY\"}),/*#__PURE__*/_jsx(Select,{options:[{label:'APR',value:'apr'},{label:'APR',value:'apr'},{label:'Multiplier',value:'multiplier'},{label:'Earned',value:'earned'},{label:'Liquidity',value:'liquidity'}],onChange:handleSortOptionChange})]}),/*#__PURE__*/_jsxs(LabelWrapper,{style:{marginLeft:16},children:[/*#__PURE__*/_jsx(Text,{children:\"SEARCH\"}),/*#__PURE__*/_jsx(SearchInput,{onChange:handleChangeQuery,value:query})]})]})]}),renderContent()]})]});};export default Farms;","map":{"version":3,"sources":["/Volumes/evo970/shift2-fcb8bc041d1fedb7988290b70457fa426765e2f4/src/views/Farms/Farms.tsx"],"names":["React","useEffect","useCallback","useState","Route","useRouteMatch","useLocation","useDispatch","BigNumber","useWeb3React","Image","Heading","Toggle","Text","styled","BLOCKS_PER_YEAR","SHIFT_PER_BLOCK","SHIFT_POOL_PID","FlexLayout","Page","useFarms","usePriceBnbBusd","usePriceCakeBusd","usePriceEthBusd","useRefresh","fetchFarmUserDataAsync","QuoteToken","useI18n","getBalanceNumber","orderBy","FarmCard","Table","FarmTabButtons","SearchInput","ToggleView","DesktopColumnSchema","ViewMode","Select","ControlContainer","div","theme","mediaQueries","sm","ToggleWrapper","LabelWrapper","FilterContainer","ViewControls","StyledImage","Header","colors","gradients","bubblegum","Farms","path","pathname","TranslateString","farmsLP","cakePrice","bnbPrice","query","setQuery","TABLE","viewMode","setViewMode","ethPriceUsd","account","sortOption","setSortOption","dispatch","fastRefresh","stackedOnly","setStackedOnly","activeFarms","filter","farm","pid","multiplier","inactiveFarms","stackedOnlyFarms","userData","stakedBalance","isGreaterThan","sortFarms","farms","Number","slice","earnings","liquidity","farmsList","farmsToDisplay","cakePriceVsBNB","find","tokenPriceVsQuote","farmsToDisplayWithAPY","map","tokenAmount","lpTotalInQuoteToken","cakeRewardPerBlock","times","poolWeight","cakeRewardPerYear","apy","quoteTokenSymbol","BUSD","UST","ETH","SHIFT","dual","cakeApy","dualApy","rewardPerBlock","plus","BNB","lowercaseQuery","toLowerCase","lpSymbol","includes","handleChangeQuery","event","target","value","isActive","farmsStaked","rowData","quoteTokenAdresses","tokenAddresses","lpLabel","split","toUpperCase","replace","row","apr","toNumber","toLocaleString","maximumFractionDigits","originalValue","image","toLocaleLowerCase","label","earned","details","renderContent","length","columnSchema","columns","column","id","name","sort","a","b","original","sortable","handleSortOptionChange","option","mode","marginLeft"],"mappings":"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","sourcesContent":["import React, { useEffect, useCallback, useState } from 'react'\nimport { Route, useRouteMatch, useLocation } from 'react-router-dom'\nimport { useDispatch } from 'react-redux'\nimport BigNumber from 'bignumber.js'\nimport { useWeb3React } from '@web3-react/core'\nimport { Image, Heading, RowType, Toggle, Text } from '@pancakeswap-libs/uikit'\nimport styled from 'styled-components'\nimport { BLOCKS_PER_YEAR, SHIFT_PER_BLOCK, SHIFT_POOL_PID } from 'config'\nimport FlexLayout from 'components/layout/Flex'\nimport Page from 'components/layout/Page'\nimport { useFarms, usePriceBnbBusd, usePriceCakeBusd, usePriceEthBusd } from 'state/hooks'\nimport useRefresh from 'hooks/useRefresh'\nimport { fetchFarmUserDataAsync } from 'state/actions'\nimport { QuoteToken } from 'config/constants/types'\nimport useI18n from 'hooks/useI18n'\nimport { getBalanceNumber } from 'utils/formatBalance'\nimport { orderBy } from 'lodash'\n\nimport FarmCard, { FarmWithStakedValue } from './components/FarmCard/FarmCard'\nimport Table from './components/FarmTable/FarmTable'\nimport FarmTabButtons from './components/FarmTabButtons'\nimport SearchInput from './components/SearchInput'\nimport { RowProps } from './components/FarmTable/Row'\nimport ToggleView from './components/ToggleView/ToggleView'\nimport { DesktopColumnSchema, ViewMode } from './components/types'\nimport Select, { OptionProps } from './components/Select/Select'\n\nconst ControlContainer = styled.div`\n  display: flex;\n  width: 100%;\n  align-items: center;\n  position: relative;\n\n  justify-content: space-between;\n  flex-direction: column;\n\n  ${({ theme }) => theme.mediaQueries.sm} {\n    flex-direction: row;\n    flex-wrap: wrap;\n    padding: 16px 32px;\n    background: rgb(33, 33, 49);\n\n  }\n`\n\nconst ToggleWrapper = styled.div`\n  display: flex;\n  align-items: center;\n  margin-left: 10px;\n\n  ${Text} {\n    margin-left: 8px;\n  }\n`\n\nconst LabelWrapper = styled.div`\n  > ${Text} {\n    font-size: 12px;\n  }\n`\n\nconst FilterContainer = styled.div`\n  display: flex;\n  align-items: center;\n  width: 100%;\n  padding: 8px 0px;\n\n  ${({ theme }) => theme.mediaQueries.sm} {\n    width: auto;\n    padding: 0;\n  }\n`\n\nconst ViewControls = styled.div`\n  flex-wrap: wrap;\n  justify-content: space-between;\n  display: flex;\n  align-items: center;\n  width: 100%;\n\n  > div {\n    padding: 8px 0px;\n  }\n\n  ${({ theme }) => theme.mediaQueries.sm} {\n    justify-content: flex-start;\n    width: auto;\n\n    > div {\n      padding: 0;\n    }\n  }\n`\n\nconst StyledImage = styled(Image)`\n  margin-left: auto;\n  margin-right: auto;\n  margin-top: 58px;\n`\n\nconst Header = styled.div`\n  padding: 22px 0px;\n  // background: ${({ theme }) => theme.colors.gradients.bubblegum};\n  margin-left: 16%;\n\n  padding-left: 76px;\n  padding-right: 16px;\n\n  ${({ theme }) => theme.mediaQueries.sm} {\n    padding-left: 24px;\n    padding-right: 24px;\n  }\n`\n\nconst Farms: React.FC = () => {\n  const { path } = useRouteMatch()\n  const { pathname } = useLocation()\n  const TranslateString = useI18n()\n  const farmsLP = useFarms()\n  const cakePrice = usePriceCakeBusd()\n  const bnbPrice = usePriceBnbBusd()\n  const [query, setQuery] = useState('')\n  const [viewMode, setViewMode] = useState(ViewMode.TABLE)\n  const ethPriceUsd = usePriceEthBusd()\n  const { account } = useWeb3React()\n  const [sortOption, setSortOption] = useState('hot')\n\n  const dispatch = useDispatch()\n  const { fastRefresh } = useRefresh()\n  useEffect(() => {\n    if (account) {\n      dispatch(fetchFarmUserDataAsync(account))\n    }\n  }, [account, dispatch, fastRefresh])\n\n  const [stackedOnly, setStackedOnly] = useState(false)\n\n  const activeFarms = farmsLP.filter((farm) => farm.pid !== 0 && farm.multiplier !== '0X')\n  const inactiveFarms = farmsLP.filter((farm) => farm.pid !== 0 && farm.multiplier === '0X')\n\n  const stackedOnlyFarms = activeFarms.filter(\n    (farm) => farm.userData && new BigNumber(farm.userData.stakedBalance).isGreaterThan(0),\n  )\n\n  const sortFarms = (farms: FarmWithStakedValue[]): FarmWithStakedValue[] => {\n    switch (sortOption) {\n      case 'apr':\n        return orderBy(farms, 'apy', 'desc')\n      case 'multiplier':\n        return orderBy(farms, (farm: FarmWithStakedValue) => Number(farm.multiplier.slice(0, -1)), 'desc')\n      case 'earned':\n        return orderBy(farms, (farm: FarmWithStakedValue) => (farm.userData ? farm.userData.earnings : 0), 'desc')\n      case 'liquidity':\n        return orderBy(farms, (farm: FarmWithStakedValue) => Number(farm.liquidity), 'desc')\n      default:\n        return farms\n    }\n  }\n\n  // /!\\ This function will be removed soon\n  // This function compute the APY for each farm and will be replaced when we have a reliable API\n  // to retrieve assets prices against USD\n  const farmsList = useCallback(\n    (farmsToDisplay): FarmWithStakedValue[] => {\n      const cakePriceVsBNB = new BigNumber(farmsLP.find((farm) => farm.pid === SHIFT_POOL_PID)?.tokenPriceVsQuote || 0)\n      let farmsToDisplayWithAPY: FarmWithStakedValue[] = farmsToDisplay.map((farm) => {\n        if (!farm.tokenAmount || !farm.lpTotalInQuoteToken) {\n          return farm\n        }\n        const cakeRewardPerBlock = SHIFT_PER_BLOCK.times(farm.poolWeight)\n        const cakeRewardPerYear = cakeRewardPerBlock.times(BLOCKS_PER_YEAR)\n\n        // cakePriceInQuote * cakeRewardPerYear / lpTotalInQuoteToken\n        let apy = cakePriceVsBNB.times(cakeRewardPerYear).div(farm.lpTotalInQuoteToken)\n\n        if (farm.quoteTokenSymbol === QuoteToken.BUSD || farm.quoteTokenSymbol === QuoteToken.UST) {\n          apy = cakePriceVsBNB.times(cakeRewardPerYear).div(farm.lpTotalInQuoteToken).times(bnbPrice)\n        } else if (farm.quoteTokenSymbol === QuoteToken.ETH) {\n          apy = cakePrice.div(ethPriceUsd).times(cakeRewardPerYear).div(farm.lpTotalInQuoteToken)\n        } else if (farm.quoteTokenSymbol === QuoteToken.SHIFT) {\n          apy = cakeRewardPerYear.div(farm.lpTotalInQuoteToken)\n        } else if (farm.dual) {\n          const cakeApy =\n            farm && cakePriceVsBNB.times(cakeRewardPerBlock).times(BLOCKS_PER_YEAR).div(farm.lpTotalInQuoteToken)\n          const dualApy =\n            farm.tokenPriceVsQuote &&\n            new BigNumber(farm.tokenPriceVsQuote)\n              .times(farm.dual.rewardPerBlock)\n              .times(BLOCKS_PER_YEAR)\n              .div(farm.lpTotalInQuoteToken)\n\n          apy = cakeApy && dualApy && cakeApy.plus(dualApy)\n        }\n\n        let liquidity = farm.lpTotalInQuoteToken\n\n        if (!farm.lpTotalInQuoteToken) {\n          liquidity = null\n        }\n        if (farm.quoteTokenSymbol === QuoteToken.BNB) {\n          liquidity = bnbPrice.times(farm.lpTotalInQuoteToken)\n        }\n        if (farm.quoteTokenSymbol === QuoteToken.SHIFT) {\n          liquidity = cakePrice.times(farm.lpTotalInQuoteToken)\n        }\n\n        if (farm.quoteTokenSymbol === QuoteToken.ETH) {\n          liquidity = ethPriceUsd.times(farm.lpTotalInQuoteToken)\n        }\n\n        return { ...farm, apy, liquidity }\n      })\n\n      if (query) {\n        const lowercaseQuery = query.toLowerCase()\n        farmsToDisplayWithAPY = farmsToDisplayWithAPY.filter((farm: FarmWithStakedValue) => {\n          if (farm.lpSymbol.toLowerCase().includes(lowercaseQuery)) {\n            return true\n          }\n\n          return false\n        })\n      }\n      return farmsToDisplayWithAPY\n    },\n    [bnbPrice, farmsLP, query, cakePrice, ethPriceUsd],\n  )\n\n  const handleChangeQuery = (event: React.ChangeEvent<HTMLInputElement>) => {\n    setQuery(event.target.value)\n  }\n\n  const isActive = !pathname.includes('history')\n  let farmsStaked = []\n  if (isActive) {\n    farmsStaked = stackedOnly ? farmsList(stackedOnlyFarms) : farmsList(activeFarms)\n  } else {\n    farmsStaked = farmsList(inactiveFarms)\n  }\n\n  farmsStaked = sortFarms(farmsStaked)\n\n  const rowData = farmsStaked.map((farm) => {\n    const { quoteTokenAdresses, quoteTokenSymbol, tokenAddresses } = farm\n    const lpLabel = farm.lpSymbol && farm.lpSymbol.split(' ')[0].toUpperCase().replace('PANSHIFT', '')\n\n    const row: RowProps = {\n      apr: {\n        value:\n          farm.apy &&\n          farm.apy.times(new BigNumber(100)).toNumber().toLocaleString('en-US', { maximumFractionDigits: 2 }),\n        multiplier: farm.multiplier,\n        lpLabel,\n        quoteTokenAdresses,\n        quoteTokenSymbol,\n        tokenAddresses,\n        cakePrice,\n        originalValue: farm.apy,\n      },\n      farm: {\n        image: farm.lpSymbol.split(' ')[0].toLocaleLowerCase(),\n        label: lpLabel,\n        pid: farm.pid,\n      },\n      earned: {\n        earnings: farm.userData ? getBalanceNumber(new BigNumber(farm.userData.earnings)) : null,\n        pid: farm.pid,\n      },\n      liquidity: {\n        liquidity: farm.liquidity,\n      },\n      multiplier: {\n        multiplier: farm.multiplier,\n      },\n      details: farm,\n    }\n\n    return row\n  })\n\n  const renderContent = (): JSX.Element => {\n    if (viewMode === ViewMode.TABLE && rowData.length) {\n      const columnSchema = DesktopColumnSchema\n\n      const columns = columnSchema.map((column) => ({\n        id: column.id,\n        name: column.name,\n        label: column.label,\n        sort: (a: RowType<RowProps>, b: RowType<RowProps>) => {\n          switch (column.name) {\n            case 'farm':\n              return b.id - a.id\n            case 'apr':\n              if (a.original.apr.value && b.original.apr.value) {\n                return Number(a.original.apr.value) - Number(b.original.apr.value)\n              }\n\n              return 0\n            case 'earned':\n              return a.original.earned.earnings - b.original.earned.earnings\n            default:\n              return 1\n          }\n        },\n        sortable: column.sortable,\n      }))\n\n      return <Table data={rowData} columns={columns} />\n    }\n\n    return (\n      <div>\n        <FlexLayout>\n          <Route exact path={`${path}`}>\n            {farmsStaked.map((farm) => (\n              <FarmCard\n                key={farm.pid}\n                farm={farm}\n                bnbPrice={bnbPrice}\n                cakePrice={cakePrice}\n                ethPrice={ethPriceUsd}\n                account={account}\n                removed={false}\n              />\n            ))}\n          </Route>\n          <Route exact path={`${path}/history`}>\n            {farmsStaked.map((farm) => (\n              <FarmCard\n                key={farm.pid}\n                farm={farm}\n                bnbPrice={bnbPrice}\n                cakePrice={cakePrice}\n                ethPrice={ethPriceUsd}\n                account={account}\n                removed\n              />\n            ))}\n          </Route>\n        </FlexLayout>\n      </div>\n    )\n  }\n\n  const handleSortOptionChange = (option: OptionProps): void => {\n    setSortOption(option.value)\n  }\n\n  return (\n    <>\n      <Header>\n        <Heading as=\"h3\" size=\"xxl\" color=\"white\" mb=\"4px\" padding=\"80px\">\n          {TranslateString(999, 'LIQUIDITY FARM')}\n        </Heading>\n      \n      </Header>\n      <Page>\n        <ControlContainer>\n          <ViewControls>\n            <ToggleView viewMode={viewMode} onToggle={(mode: ViewMode) => setViewMode(mode)} />\n            <ToggleWrapper>\n              <Toggle checked={stackedOnly} onChange={() => setStackedOnly(!stackedOnly)} scale=\"sm\" />\n              <Text> {TranslateString(1116, 'Staked only')}</Text>\n            </ToggleWrapper>\n            <FarmTabButtons />\n          </ViewControls>\n          <FilterContainer>\n            <LabelWrapper>\n              <Text>FILTER BY</Text>\n              <Select\n                options={[\n                  {\n                    label: 'APR',\n                    value: 'apr',\n                  },\n                  {\n                    label: 'APR',\n                    value: 'apr',\n                  },\n                  {\n                    label: 'Multiplier',\n                    value: 'multiplier',\n                  },\n                  {\n                    label: 'Earned',\n                    value: 'earned',\n                  },\n                  {\n                    label: 'Liquidity',\n                    value: 'liquidity',\n                  },\n                ]}\n                onChange={handleSortOptionChange}\n              />\n            </LabelWrapper>\n            <LabelWrapper style={{ marginLeft: 16 }}>\n              <Text>SEARCH</Text>\n              <SearchInput onChange={handleChangeQuery} value={query} />\n            </LabelWrapper>\n          </FilterContainer>\n        </ControlContainer>\n        {renderContent()}\n        {/* <StyledImage src=\"/images/3dpan.png\" alt=\"Pancake illustration\" width={120} height={103} /> */}\n      </Page>\n    </>\n  )\n}\n\nexport default Farms\n"]},"metadata":{},"sourceType":"module"}